services:
  # Servicio Web - Backend Spring Boot
  - type: web
    name: ecoshop-backend
    env: java
    region: oregon
    plan: free
    buildCommand: ./mvnw clean install -DskipTests
    startCommand: java -jar target/ecoshop-0.0.1-SNAPSHOT.jar
    envVars:
      # Perfil de Spring para producción
      - key: SPRING_PROFILES_ACTIVE
        value: prod
      # Base de datos - Se conectará automáticamente a la base de datos PostgreSQL
      # Render proporciona connectionString que ya incluye la URL completa en formato JDBC
      - key: DB_URL
        fromDatabase:
          name: ecoshop-db
          property: connectionString
      - key: DB_USERNAME
        fromDatabase:
          name: ecoshop-db
          property: user
      - key: DB_PASSWORD
        fromDatabase:
          name: ecoshop-db
          property: password
      # Configuración de JPA para producción
      - key: JPA_DDL_AUTO
        value: update
      - key: JPA_SHOW_SQL
        value: false
      # Configuración de logging
      - key: LOG_LEVEL
        value: INFO
      - key: SECURITY_LOG_LEVEL
        value: WARN

  # Base de datos PostgreSQL
  - type: pspg
    name: ecoshop-db
    region: oregon
    plan: free
    databaseName: ecoshop
    user: ecoshop_user

